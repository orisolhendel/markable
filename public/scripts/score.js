const resTest = '{"request_id":"1693740522,08bda2d9-4ef5-43ef-aa63-6e5df0237115","result":{"skin_age":{"value":51},"eye_pouch":{"value":0,"confidence":0.9085579},"dark_circle":{"value":1,"confidence":1},"dark_circle_severity":{"value":1,"confidence":1},"forehead_wrinkle":{"value":0,"confidence":0.8493166},"crows_feet":{"value":0,"confidence":0.6105212},"eye_finelines":{"value":1,"confidence":0.9250366},"eye_finelines_severity":{"value":2,"confidence":0.7434581},"glabella_wrinkle":{"value":0,"confidence":0.96180874},"nasolabial_fold":{"value":1,"confidence":0.7981224},"nasolabial_fold_severity":{"value":1,"confidence":0.29430044},"skin_type":{"skin_type":3,"details":[{"value":0,"confidence":0.18605036},{"value":0,"confidence":0.035560198},{"value":0,"confidence":0.10813014},{"value":1,"confidence":0.6702593}]},"pores_forehead":{"value":0,"confidence":1},"pores_left_cheek":{"value":0,"confidence":1},"pores_right_cheek":{"value":0,"confidence":1},"pores_jaw":{"value":0,"confidence":1},"blackhead":{"value":0,"confidence":1},"skintone_ita":{"ITA":20.94286,"skintone":3},"skin_hue_ha":{"HA":36.886284,"skin_hue":2},"acne":{"rectangle":[],"confidence":[],"polygon":[]},"mole":{"rectangle":[{"left":438,"top":449,"width":9,"height":11}],"confidence":[0.31871122],"polygon":[[{"x":445,"y":449},{"x":443,"y":456},{"x":440,"y":451}]]},"brown_spot":{"rectangle":[{"left":513,"top":221,"width":6,"height":5},{"left":417,"top":513,"width":9,"height":8},{"left":545,"top":492,"width":8,"height":7},{"left":555,"top":241,"width":9,"height":9},{"left":471,"top":242,"width":9,"height":7},{"left":545,"top":456,"width":6,"height":5},{"left":405,"top":359,"width":6,"height":6},{"left":533,"top":235,"width":12,"height":9},{"left":468,"top":426,"width":6,"height":5},{"left":494,"top":424,"width":4,"height":6},{"left":563,"top":304,"width":4,"height":4},{"left":505,"top":556,"width":5,"height":6},{"left":492,"top":510,"width":9,"height":8}],"confidence":[0.5559444,0.44896308,0.4378932,0.42526555,0.4204683,0.40154696,0.38000244,0.36537284,0.34569472,0.33317164,0.33101192,0.3119705,0.30865827],"polygon":[[],[{"x":425,"y":518},{"x":422,"y":519},{"x":419,"y":515}],[{"x":552,"y":497},{"x":547,"y":497},{"x":546,"y":494},{"x":551,"y":493}],[{"x":563,"y":249},{"x":559,"y":248},{"x":557,"y":243},{"x":563,"y":241}],[{"x":479,"y":245},{"x":473,"y":247},{"x":474,"y":244}],[],[],[{"x":544,"y":241},{"x":540,"y":242},{"x":534,"y":238},{"x":542,"y":237}],[{"x":473,"y":428},{"x":470,"y":430},{"x":468,"y":427}],[],[],[],[{"x":499,"y":514},{"x":493,"y":515},{"x":492,"y":510}]]},"closed_comedones":{"rectangle":[],"confidence":[],"polygon":[]},"acne_mark":{"rectangle":[],"confidence":[],"polygon":[]},"acne_nodule":{"rectangle":[],"confidence":[],"polygon":[]},"acne_pustule":{"rectangle":[],"confidence":[],"polygon":[]},"blackhead_count":1,"skintone":{"value":2,"confidence":0.42089844},"fine_line":{"forehead_count":1,"left_undereye_count":0,"right_undereye_count":0,"left_cheek_count":0,"right_cheek_count":0,"left_crowsfeet_count":0,"right_crowsfeet_count":0,"glabella_count":0},"wrinkle_count":{"forehead_count":1,"left_undereye_count":1,"right_undereye_count":1,"left_mouth_count":0,"right_mouth_count":0,"left_nasolabial_count":1,"right_nasolabial_count":1,"glabella_count":0,"left_cheek_count":0,"right_cheek_count":0,"left_crowsfeet_count":1,"right_crowsfeet_count":1},"oily_intensity":{"t_zone":{"area":0.32,"intensity":2},"left_cheek":{"area":0.12,"intensity":0},"right_cheek":{"area":0.2,"intensity":1},"chin_area":{"area":0.36,"intensity":2},"full_face":{"area":0.28,"intensity":2}},"enlarged_pore_count":{"forehead_count":9,"left_cheek_count":2,"right_cheek_count":0,"chin_count":5},"right_dark_circle_rete":{"value":0},"left_dark_circle_rete":{"value":0},"right_dark_circle_pigment":{"value":2},"left_dark_circle_pigment":{"value":2},"right_dark_circle_structural":{"value":0},"left_dark_circle_structural":{"value":1},"dark_circle_mark":{"left_eye_rect":{"left":389,"top":312,"width":72,"height":63},"right_eye_rect":{"left":511,"top":305,"width":73,"height":64}},"water":{"water_severity":32,"water_area":0.251,"water_forehead":{"area":0.063},"water_leftcheek":{"area":0.573},"water_rightcheek":{"area":0.176}},"rough":{"rough_severity":12,"rough_area":0.164,"rough_forehead":{"area":0.166},"rough_leftcheek":{"area":0.186},"rough_rightcheek":{"area":0.052},"rough_jaw":{"area":0.243}},"left_mouth_wrinkle_severity":{"value":0},"right_mouth_wrinkle_severity":{"value":0},"forehead_wrinkle_severity":{"value":0},"left_crows_feet_severity":{"value":0},"right_crows_feet_severity":{"value":0},"left_eye_finelines_severity":{"value":0},"right_eye_finelines_severity":{"value":0},"glabella_wrinkle_severity":{"value":0},"left_nasolabial_fold_severity":{"value":2},"right_nasolabial_fold_severity":{"value":1},"left_cheek_wrinkle_severity":{"value":0},"right_cheek_wrinkle_severity":{"value":0},"forehead_wrinkle_info":{"wrinkle_score":3,"wrinkle_severity_level":0,"wrinkle_norm_length":0.34289107756574233,"wrinkle_norm_depth":0.3478389205144424,"wrinkle_pixel_density":0.0004890617973524625,"wrinkle_area_ratio":0.0005564625269990965,"wrinkle_deep_ratio":0.6774193548387096,"wrinkle_deep_num":1,"wrinkle_shallow_num":1},"left_eye_wrinkle_info":{"wrinkle_score":1,"wrinkle_severity_level":0,"wrinkle_norm_length":0.24571804673358047,"wrinkle_norm_depth":0.19117647058823528,"wrinkle_pixel_density":0.06485651580127609,"wrinkle_area_ratio":0.01829924650161464,"wrinkle_deep_ratio":0.9166666666666666,"wrinkle_deep_num":1,"wrinkle_shallow_num":0},"right_eye_wrinkle_info":{"wrinkle_score":1,"wrinkle_severity_level":0,"wrinkle_norm_length":0.20370021093167762,"wrinkle_norm_depth":0.11686274509803922,"wrinkle_pixel_density":0.051742385761588634,"wrinkle_area_ratio":0.007251381215469613,"wrinkle_deep_ratio":0.9,"wrinkle_deep_num":1,"wrinkle_shallow_num":0},"left_crowsfeet_wrinkle_info":{"wrinkle_score":0,"wrinkle_severity_level":0,"wrinkle_norm_length":0,"wrinkle_norm_depth":0,"wrinkle_pixel_density":0,"wrinkle_area_ratio":0,"wrinkle_deep_ratio":0,"wrinkle_deep_num":0,"wrinkle_shallow_num":0},"right_crowsfeet_wrinkle_info":{"wrinkle_score":0,"wrinkle_severity_level":0,"wrinkle_norm_length":0,"wrinkle_norm_depth":0,"wrinkle_pixel_density":0,"wrinkle_area_ratio":0,"wrinkle_deep_ratio":0,"wrinkle_deep_num":0,"wrinkle_shallow_num":0},"glabella_wrinkle_info":{"wrinkle_score":0,"wrinkle_severity_level":0,"wrinkle_norm_length":0,"wrinkle_norm_depth":0,"wrinkle_pixel_density":0,"wrinkle_area_ratio":0,"wrinkle_deep_ratio":0,"wrinkle_deep_num":0,"wrinkle_shallow_num":0},"left_mouth_wrinkle_info":{"wrinkle_score":0,"wrinkle_severity_level":0,"wrinkle_norm_length":0,"wrinkle_norm_depth":0,"wrinkle_pixel_density":0,"wrinkle_area_ratio":0,"wrinkle_deep_ratio":0,"wrinkle_deep_num":0,"wrinkle_shallow_num":0},"right_mouth_wrinkle_info":{"wrinkle_score":0,"wrinkle_severity_level":0,"wrinkle_norm_length":0,"wrinkle_norm_depth":0,"wrinkle_pixel_density":0,"wrinkle_area_ratio":0,"wrinkle_deep_ratio":0,"wrinkle_deep_num":0,"wrinkle_shallow_num":0},"left_nasolabial_wrinkle_info":{"wrinkle_score":42,"wrinkle_severity_level":2,"wrinkle_norm_length":0.2580900583828168,"wrinkle_norm_depth":0.41871148459383756,"wrinkle_pixel_density":0.059553390447794126,"wrinkle_area_ratio":0.18946047678795483,"wrinkle_deep_ratio":1,"wrinkle_deep_num":1,"wrinkle_shallow_num":0},"right_nasolabial_wrinkle_info":{"wrinkle_score":21,"wrinkle_severity_level":1,"wrinkle_norm_length":0.25071605671473635,"wrinkle_norm_depth":0.21441753171856978,"wrinkle_pixel_density":0.06305358825316046,"wrinkle_area_ratio":0.004786324786324786,"wrinkle_deep_ratio":1,"wrinkle_deep_num":1,"wrinkle_shallow_num":0},"left_cheek_wrinkle_info":{"wrinkle_score":0,"wrinkle_severity_level":0,"wrinkle_norm_length":0,"wrinkle_norm_depth":0,"wrinkle_pixel_density":0,"wrinkle_area_ratio":0,"wrinkle_deep_ratio":0,"wrinkle_deep_num":0,"wrinkle_shallow_num":0},"right_cheek_wrinkle_info":{"wrinkle_score":0,"wrinkle_severity_level":0,"wrinkle_norm_length":0,"wrinkle_norm_depth":0,"wrinkle_pixel_density":0,"wrinkle_area_ratio":0,"wrinkle_deep_ratio":0,"wrinkle_deep_num":0,"wrinkle_shallow_num":0},"score_info":{"dark_circle_score":67,"skin_type_score":42,"wrinkle_score":93,"oily_intensity_score":49,"pores_score":100,"blackhead_score":100,"acne_score":100,"sensitivity_score":30,"melanin_score":54,"water_score":68,"rough_score":88,"total_score":74,"pores_type_score":{"pores_forehead_score":99,"pores_leftcheek_score":100,"pores_rightcheek_score":100,"pores_jaw_score":99},"dark_circle_type_score":{"left_dark_circle_score":78,"right_dark_circle_score":89}},"left_eye_pouch_rect":{"left":389,"top":312,"width":72,"height":63},"right_eye_pouch_rect":{"left":511,"top":305,"width":73,"height":64},"melasma":{"value":0,"confidence":0.36094823},"freckle":{"value":0,"confidence":0.14942165},"image_quality":{"face_rect":{"left":343,"top":177,"width":282,"height":415},"face_ratio":0.14370225,"hair_occlusion":0.19598022,"face_orientation":{"yaw":-6.200235,"pitch":-7.5729055,"roll":0.21487783},"glasses":0},"sensitivity_type_v1":0},"face_rectangle":{"top":263,"left":327,"width":321,"height":320},"error_code":0,"log_id":"665412"}';

let scoreJson = ""

const updateScoreJson = (s, delim) => {
    if (!delim) {
        delim = ",";
    } else if (delim === "no_delim") {
        delim = "";
    }
    const arr = s.split(/:/i);
    if (arr.length === 1) {
        scoreJson += `${s}${delim}`;
    } else {
        scoreJson += `"${arr[0]}":${arr[1]}${delim}`;
    }
}

const gradeScore = (x, input, output) => {
    for (let i = 0; i < input.length; i++) {
        if (x < input[i]) {
            return output[i];
        }
    }
}

const buildSymptomListForJson = sympList => {
    let s = "[";
    sympList.forEach ((symp, index) => {
        s += `"${symp}"`;
        if (index < sympList.length - 1) {
            s += ",";
        }
    })
    s += "]";
    return s;
}

const calcScore = (res, userInfo) => {
     
    // debug:
    if (!res) {
        res = resTest;
        userInfo = {};
        userInfo.symptoms = ['symp1', 'symp2', 'symp3'];
        userInfo.age = 40;
        userInfo.other = "testing123"
    }
    //====================================

    scoreJson = "{";

    if (userInfo.googleData != null) {
        scoreJson += `"google": ${JSON.stringify(userInfo.googleData)}, `;
    }
    if (userInfo.facebookData != null) {
        scoreJson +=  `"facebook": ${JSON.stringify(userInfo.facebookData)}, `;
    }

    let classification = "";

    const surg = userInfo.surg;
    const no_month = userInfo.no_month;
    const age = Number(userInfo.age);


    updateScoreJson (`surg: ${surg}`);
    updateScoreJson (`no_month: ${no_month}`);

    // if (surg || no_month) {
    //     classification = "Old";
    //     updateScoreJson (`age: ${age}`);
    //     updateScoreJson (`surg: ${surg}`);
    //     updateScoreJson (`no_month: ${no_month}`);
    //     updateScoreJson (`class: "${classification}"`, "no_delim");
    //     updateScoreJson ("}", "no_delim");

    //     return scoreJson;
    // }

    // if (age < 38) {
    //     classification = "Young";
    //     updateScoreJson (`age: ${age}`);
    //     updateScoreJson (`class: "${classification}"`, "no_delim");
    //     updateScoreJson ("}", "no_delim");
    //     return scoreJson;
    // } else if (age > 52) {
    //     classification = "Old";
    //     updateScoreJson (`age: ${age}`);
    //     updateScoreJson (`class: "${classification}"`, "no_delim");
    //     updateScoreJson ("}", "no_delim");
    //     return scoreJson;
    // }

    const symptoms = userInfo.symptoms.length;

    updateScoreJson (`symptoms: ${buildSymptomListForJson(userInfo.symptoms)}`);
    updateScoreJson (`age: ${userInfo.age}`);
    updateScoreJson (`other: "${userInfo.other}"`);

    let jres_wrapper = null;

    try {
        jres_wrapper = (JSON.parse (res));
    } catch (e) {
        console.log('res: ' + res);
        console.log('error: ' + e);
        alert ('error: ' + e)
    }
    const jres = jres_wrapper.result;

    const info = jres.score_info

    let water = info.water_score;
    updateScoreJson (`water: ${water}`)

    let pores = info.pores_score;
    updateScoreJson (`pores: ${pores}`);

    let melanin = info.melanin_score;
    updateScoreJson (`melanin: ${melanin}`);

    let dark_circle = info.dark_circle_score;
    updateScoreJson (`dark_circle: ${dark_circle}`);

    let sensitivity = info.sensitivity_score
    updateScoreJson (`sensitivity: ${sensitivity}`);

    let wrinkle = info.wrinkle_score;
    updateScoreJson(`wrinkle: ${wrinkle}`);

    let glabella_wrinkle = jres.glabella_wrinkle_info.wrinkle_severity_level;
    updateScoreJson(`glabella_wrinkle: ${glabella_wrinkle}`);

    let left_cheek_wrinkle = jres.left_cheek_wrinkle_severity.value;
    updateScoreJson(`left_cheek_wrinkle: ${left_cheek_wrinkle}`);

    let right_cheek_wrinkle = jres.right_cheek_wrinkle_severity.value;
    updateScoreJson(`right_cheek_wrinkle: ${right_cheek_wrinkle}`);

    let left_nasolabial_wrinkle = jres.left_nasolabial_wrinkle_info.wrinkle_severity_level;
    updateScoreJson(`left_nasolabial_wrinkle: ${left_nasolabial_wrinkle}`);

    let right_nasolabial_wrinkle = jres.right_nasolabial_wrinkle_info.wrinkle_severity_level;
    updateScoreJson(`right_nasolabial_wrinkle: ${right_nasolabial_wrinkle}`);

    let left_crowsfeet_wrinkle = jres.left_crowsfeet_wrinkle_info.wrinkle_severity_level;
    updateScoreJson(`left_crowsfeet_wrinkle: ${left_crowsfeet_wrinkle}`);

    let right_crowsfeet_wrinkle = jres.right_crowsfeet_wrinkle_info.wrinkle_severity_level;
    updateScoreJson(`right_crowsfeet_wrinkle: ${right_crowsfeet_wrinkle}`);

    let left_mouth_wrinkle = jres.left_mouth_wrinkle_info.wrinkle_severity_level;
    updateScoreJson(`left_mouth_wrinkle: ${left_mouth_wrinkle}`);

    let right_mouth_wrinkle = jres.right_mouth_wrinkle_info.wrinkle_severity_level;
    updateScoreJson(`right_mouth_wrinkle: ${right_mouth_wrinkle}`);
    
    let eye_pouch_val = jres.eye_pouch.value;
    let eye_pouch_conf = jres.eye_pouch.confidence;
    updateScoreJson (`eye_pouch_val: ${eye_pouch_val}`);
    updateScoreJson (`eye_pouch_conf: ${eye_pouch_conf}`);

    let skin_type_val = jres.skin_type.skin_type;
    let skin_type_conf = jres.skin_type.details[1].confidence;
    updateScoreJson (`skin_type_val: ${skin_type_val}`);
    updateScoreJson (`skin_type_conf: ${skin_type_conf}`);
    
    let forehead_wrinkle_val = jres.forehead_wrinkle.value;
    let forehead_wrinkle_conf = jres.forehead_wrinkle.confidence;
    updateScoreJson (`forehead_wrinkle_val: ${forehead_wrinkle_val}`);
    updateScoreJson (`forehead_wrinkle_conf: ${forehead_wrinkle_conf}`);

    let eye_finelines_val = jres.eye_finelines.value;
    let eye_finelines_conf = jres.eye_finelines.confidence;
    let eye_finelines_sev = jres.eye_finelines_severity.value;
    updateScoreJson (`eye_fineline_val: ${eye_finelines_val}`);
    updateScoreJson (`eye_fineline_conf: ${eye_finelines_conf}`);
    updateScoreJson (`eye_fineline_sev: ${eye_finelines_sev}`);

    let fineline_count =    jres.fine_line.forhead_count +
                            jres.fine_line.left_undereye_count + 
                            jres.fine_line.right_undereye_count + 
                            jres.fine_line.left_cheek_count + 
                            jres.fine_line.right_cheek_count + 
                            jres.fine_line.left_crowsfeet_count + 
                            jres.fine_line.right_crowsfeet_count + 
                            jres.fine_line.glabella_count;

    const water_score = gradeScore(water, [30, 50, 70, Infinity], ['error', 10, 5, 0]);
    const pore_score = gradeScore(pores, [30, 50, 70, Infinity], ['error', 10, 5, 0]);
    const melanin_score = gradeScore(melanin, [30, 50, 70, Infinity], ['error', 10, 5, 0]);
    const dark_circle_score = gradeScore(dark_circle, [30, 50, 70, Infinity], ['error', 10, 5, 0]);
    const sensitivity_score = gradeScore(sensitivity, [30, 50, 70, Infinity], ['error', 10, 5, 0]);
    const wrinkle_score = gradeScore(wrinkle, [81, 95, Infinity], [10, 5, 0]);
    const glabella_wrinkle_score = gradeScore(glabella_wrinkle, [1, 2, Infinity], [0, 5, 10]);
    const left_cheek_wrinkle_score = gradeScore(left_cheek_wrinkle, [1, 2, Infinity], [0, 5, 10]);
    const right_cheek_wrinkle_score = gradeScore(right_cheek_wrinkle, [1, 2, Infinity], [0, 5, 10]);
    const left_nasolabial_wrinkle_score = gradeScore(left_nasolabial_wrinkle, [1, 2, Infinity], [0, 5, 10]);
    const right_nasolabial_wrinkle_score = gradeScore(right_nasolabial_wrinkle, [1, 2, Infinity], [0, 5, 10]);
    const left_crowsfeet_wrinkle_score = gradeScore(left_crowsfeet_wrinkle, [1, 2, Infinity], [0, 5, 10]);
    const right_crowsfeet_wrinkle_score = gradeScore(right_crowsfeet_wrinkle, [1, 2, Infinity], [0, 5, 10]);
    const left_mouth_wrinkle_score = gradeScore(left_mouth_wrinkle, [1, 2, Infinity], [0, 5, 10]);
    const right_mouth_wrinkle_score = gradeScore(right_mouth_wrinkle, [1, 2, Infinity], [0, 5, 10]);
    const eye_pouch_score = eye_pouch_val == 1 && eye_pouch_conf > 0.1 ? 10 : 0;
    const skin_type_score = skin_type_val == 1 && skin_type_conf > 0.2 ? 10 : 0;
    const forehead_wrinkle_score = forehead_wrinkle_val == 1 && forehead_wrinkle_conf > 0.8 ? 10 : 0;
    const eye_finelines_score = eye_finelines_val == 1 && eye_finelines_conf > 0.8  && eye_finelines_sev >= 1 ? 10 : 0;
    const fineline_count_score = fineline_count > 2 ? 10 : 0;

    const factors = [water_score, pore_score, melanin_score, dark_circle_score, sensitivity_score, wrinkle_score, 
                    glabella_wrinkle_score,  
                    left_cheek_wrinkle_score, right_cheek_wrinkle_score,
                    left_nasolabial_wrinkle_score, right_nasolabial_wrinkle_score,
                    left_crowsfeet_wrinkle_score, right_crowsfeet_wrinkle_score,
                    left_mouth_wrinkle_score, right_mouth_wrinkle_score,
                    eye_pouch_score, skin_type_score, forehead_wrinkle_score, eye_finelines_score,
                    fineline_count_score];
    const factors_names = ["water_score", "pore_score", "melanin_score", "dark_circle_score", "sensitivity_score", "wrinkle_score", 
                            "glabella_wrinkle_score", 
                            "left_cheek_wrinkle_score", "right_cheek_wrinkle_score",
                            "left_nasolabial_wrinkle_score", "right_nasolabial_wrinkle_score",
                            "left_crowsfeet_wrinkle_score", "right_crowsfeet_wrinkle_score",
                            "left_mouth_wrinkle_score", "right_mouth_wrinkle_score",
                            "eye_pouch_score", "skin_type_score", "forehead_wrinkle_score", "eye_finelines_score",
                            "fineline_count_score"];

    let total_score_relative =    factors.reduce((a, b) => a + b, 0)
    const total_score_empiric = Math.round (total_score_relative / factors.length * 10);

    factors.forEach ((a, i) => updateScoreJson (`${factors_names[i]}: ${a}`));
    updateScoreJson (`total_score_relative: ${total_score_relative}`);
    updateScoreJson (`total_score_empiric: ${total_score_empiric}`);

    let total_score_empiric_plus_symptoms = total_score_empiric;

    switch (symptoms) {
        case 0:
            classification = gradeScore (total_score_relative, [80, Infinity], ["D", "C"]);
            break;
        case 1:
            classification = gradeScore (total_score_relative, [80, Infinity], ["D", "C"]);
            total_score_empiric_plus_symptoms += gradeScore (total_score_empiric, [51, 76, Infinity], [5, 5, 0]);
            break;
        case 2:
            classification = gradeScore (total_score_relative, [50, Infinity], ["C", "B"]);
            total_score_empiric_plus_symptoms += gradeScore (total_score_empiric, [51, 76, Infinity], [20, 10, 8]);
            break;
        case 3:
            classification = gradeScore (total_score_relative, [50, Infinity], ["C", "A"]);
            total_score_empiric_plus_symptoms += gradeScore (total_score_empiric, [51, 76, Infinity], [35, 25, 15]);
            break;
        default: // 4 and above
            classification = gradeScore (total_score_relative, [50, Infinity], ["B", "A"]);
            total_score_empiric_plus_symptoms += gradeScore (total_score_empiric, [51, 76, Infinity], [35, 25, 15]);
            break;
    }

    if (surg || no_month) {
        classification = "Old";
    }
    else if (age < 38) {
        classification = "Young";
    } else if (age > 52) {
        classification = "Old";
    }

    total_score_empiric_plus_symptoms = Math.min (total_score_empiric_plus_symptoms, 96);

    updateScoreJson (`total_score_empiric_plus_symptoms: ${total_score_empiric_plus_symptoms}`);
    updateScoreJson (`class: "${classification}"`, "no_delim");
    updateScoreJson ("}", "no_delim");


    console.log (scoreJson)

    return scoreJson;
}


// debug:

// for (let i = 0; i < 50; i++) {
//     let symptoms = Math.floor(Math.random() * 6);
//     let test = Math.floor(Math.random() * 71);

//     updateScoreJson (`symptoms: ${symptoms}` )
//     updateScoreJson (`test: ${test}`);

//     calcScore (res, symptoms, test);


//     updateScoreJson ("====================================================================")
//     updateScoreJson ("++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++")
//     updateScoreJson ("====================================================================")

// }






